# ⚠️ Important Warnings

This document details important limitations and considerations you should be aware of when using the Currency.js library.

## Two Decimal Places Limitation

The Currency.js library has been optimized to work with monetary values containing up to two decimal places. Using the library with values that have more than two decimal places may result in inaccuracies.

```javascript
// ✅ Recommended: values with up to 2 decimal places
const price1 = Money(19.99)
const price2 = Money(100.5)

// ⚠️ Not recommended: values with more than 2 decimal places
const price3 = Money(19.999)  // Will be rounded to 20.00
const price4 = Money(100.505) // Will be rounded to 100.51
```

## Internal Rounding

The library performs internal rounding to preserve the precision of operations. It's important to be aware of these rounding when performing calculations in sequence.

```javascript
// Example of internal rounding
const price = Money(10.565) // Internally rounded to 10.57

// Rounding in mathematical operations
const resultA = Money(10.51).times(0.33)  // 3.47 (not 3.4683)
const resultB = Money(99.99).dividedBy(3) // 33.33 (not 33.33...)

// To visualize the rounding behavior
const value = Money(10.516)
console.log(value.value) // 10.52 (rounded)
console.log(value.cents) // 1052 (value in cents after rounding)
```

## Preference for the allocate Method

To distribute values with greater precision (such as in payment installments), always prefer to use the allocate method instead of dividedBy. The allocate method ensures that the sum of the parts is exactly equal to the original value, avoiding rounding problems.

```javascript
// ❌ Less precise: using dividedBy for installments
const totalAmount = Money(100)
const installments = 3
const eachInstallment = totalAmount.dividedBy(installments) // 33.33
const totalSum = eachInstallment.times(installments)        // 99.99 (loss of 0.01)

// ✅ More precise: using allocate for installments
const totalAmount = Money(100)
const installments = totalAmount.allocate(3) // [33.34, 33.33, 33.33]
console.log(installments[0].format()) // $33.34
console.log(installments[1].format()) // $33.33
console.log(installments[2].format()) // $33.33

// The sum of the installments is exactly equal to the original value
const totalSum = installments.reduce(
  (sum, amount) => sum.plus(amount),
  Money(0),
) // 100.00
```

## Chained Operations Processing

When chaining multiple operations, be aware that each operation creates a new Money instance and that rounding is applied at each step:

```javascript
// Example of chained operations with intermediate rounding
const result = Money(33.33)
  .times(1.05)    // 34.9965 -> rounded to 35.00
  .minus(0.5)     // 34.50
  .dividedBy(3)   // 11.50

// For critical operations requiring absolute precision,
// consider reducing the number of chained operations
```

## Compatibility with Different Locales

When working with different regional settings (locales), make sure to provide both the correct currency code and locale to ensure proper formatting:

```javascript
// Incorrect combinations may lead to inaccurate formatting
const amount = Money(1234.56)

// ✅ Correct: matching currency and locale
amount.format({ currencyCode: 'BRL', locale: 'pt-BR' }) // R$ 1.234,56

// ⚠️ Be careful: different currency and locale
amount.format({ currencyCode: 'USD', locale: 'pt-BR' }) // US$ 1.234,56
```